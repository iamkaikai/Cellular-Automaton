let cellLength,count,p,ruleNum,autoCount=0,ruleset=[],cell=[],row=0,nextCell=[],colorRand=randBetweenInt(0,119),cRand=randBetweenInt(0,8),cBW=randBetweenInt(0,255),p3=randBetweenInt(1,3),patternRand=randBetween(0,1),cellSize=1,pInitial=["random","center","division"];pInitial=pInitial[1];let ruleDes=60;for(;ruleNum!=ruleDes;){ruleNum=0,ruleset=[];for(let e=7;e>=0;e--)x=randBetweenInt(0,1),ruleset.push(x),ruleNum+=x*2**e}function setup(){noiseSeed(randBetweenInt(0,1e4)),noStroke(),pixelDensity(2),canvas=createCanvas(windowWidth,windowHeight),background(255),initialState(),console.log("["+cell+"],"),C=new CA,textSize(32)}function draw(){C.nextGen(),C.update(),C.draw(row),row+=1,fill(0),rect(width-200,height-50,200,50),fill(255),text("RULE = "+ruleNum,width-185,height-14)}function initialState(){if(cellLength=int(width/cellSize),cellSize=int(width/cellLength),"random"==pInitial)for(let e=0;e<cellLength;e++)cell.push(randBetweenInt(0,1));else if("center"==pInitial){for(let e=0;e<cellLength;e++)cell.push(0);cell[int(cellLength/2)]=1}else if("division"==pInitial){for(let e=0;e<cellLength;e++)cell.push(1);div=randBetweenInt(2,5),interval=int(cellLength/div);for(let e=1;e<div;e++)cell[interval*e]=0}}function CA(){this.draw=function(e){for(let l=0;l<cellLength;l++)0==cell[l]&&fill(255),1==cell[l]&&fill(0),rect(l*cellSize,e*cellSize,cellSize)},this.nextGen=function(){nextCell=[];for(let e=0;e<cellLength;e++){let l=cell[e-1],t=cell[e],n=cell[e+1];newState=null==l&&null==t?rules(0,0,n):null==l?rules(0,t,n):null==t&&null==n?rules(l,0,0):rules(l,t,null==n?0:n),nextCell.push(newState)}this.update=function(){cell=nextCell}}}function rules(e,l,t){let n;return n=1==e&&1==l&&1==t?ruleset[0]:1==e&&1==l&&0==t?ruleset[1]:1==e&&0==l&&1==t?ruleset[2]:1==e&&0==l&&0==t?ruleset[3]:0==e&&1==l&&1==t?ruleset[4]:0==e&&1==l&&0==t?ruleset[5]:0==e&&0==l&&1==t?ruleset[6]:0==e&&0==l&&0==t?ruleset[7]:n,n}function randBetween(e,l){return e+(l-e)*fxrand()}function randBetweenInt(e,l){return Math.floor(e+(l+1-e)*fxrand())}let pause=!1;function keyTyped(){"p"===key&&(0==pause?(frameRate(0),pause=!0):(pause=!1,frameRate(60))),"s"===key&&save(canvas,"image.jpg")}